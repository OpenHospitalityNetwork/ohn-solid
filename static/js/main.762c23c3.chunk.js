(this["webpackJsonpohn-solid-client"]=this["webpackJsonpohn-solid-client"]||[]).push([[0],{129:function(e,t,n){},130:function(e,t,n){},185:function(e,t){},207:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(49),u=n.n(a),i=(n(129),n(130),n(45)),s=function(){return Object(i.b)()},o=i.c,d=n(6),l=n(0),b=n.n(l),f=n(2),p=n(15),j=n(70),h=n(10),O=n(26),m=n(27),v=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,a,u,i,s,o,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.c)(t,{fetch:O.fetch});case 2:if(a=e.sent,u=Object(h.h)(a,t)){e.next=6;break}return e.abrupt("return",null);case 6:if(i=null!==(n=Object(h.f)(u,m.d.fn)||Object(h.f)(u,m.a.name))&&void 0!==n?n:"",!(s=null!==(r=Object(h.j)(u,m.d.hasPhoto))&&void 0!==r?r:"")){e.next=14;break}return e.next=11,x(s);case 11:e.t0=e.sent,e.next=15;break;case 14:e.t0="";case 15:return o=e.t0,d=null!==(c=Object(h.f)(u,m.d.note)||Object(h.g)(u,m.d.note,"en"))&&void 0!==c?c:"",e.abrupt("return",{id:t,name:i,avatar:o,about:d,communityIds:[]});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.fetch)(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,c=URL.createObjectURL(r),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){return"http://www.w3.org/2003/01/geo/wgs84_pos#"+e},I=function(e){var t;return(null===(t=/^(https:\/\/.*)\/profile\/card#me$/g.exec(e))||void 0===t?void 0:t[1])+"/public/hospex.ttl"},w=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=I(t),e.next=3,Object(h.c)(n,{fetch:O.fetch});case 3:return r=e.sent,c=Object(h.i)(r),a=c.map((function(e){return{thing:e,url:Object(h.j)(e,m.b.type)}})).filter((function(e){var t=e.thing,n=e.url;return t&&"https://hospex.example.com/terms/0.1#Accommodation"===n})).map((function(e){return e.thing})).map((function(e){var n=Object(h.a)(e),c=Object(h.j)(e,g("location"));if(!c)return null;var a=Object(h.h)(r,c),u=a&&Object(h.b)(a,g("lat")),i=a&&Object(h.b)(a,g("long"));if(!u||!i)return null;var s=Object(h.d)(e,m.c.comment);return{id:n,userId:t,position:[u,i],about:Object.fromEntries(s)}})).filter((function(e){return null!==e})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=Object(p.b)("offer/getOffersOfUser",function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),k=Object(p.c)({name:"offer",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(y.fulfilled,(function(e,t){t.payload.forEach((function(t){e.byId[t.id]=t,e.allIds.includes(t.id)||e.allIds.push(t.id)}))}))}}),S=Object(j.a)((function(e){return e.offer}),(function(e){var t=e.byId;return e.allIds.map((function(e){return t[e]}))})),C=k.reducer,L=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=I(t),e.next=3,Object(h.c)(n,{fetch:O.fetch});case 3:if(r=e.sent,c=Object(h.h)(r,t)){e.next=7;break}return e.abrupt("return",[]);case 7:return a=Object(h.k)(c,"https://hospex.example.com/terms/0.1#memberOf"),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,a,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.c)(t,{fetch:O.fetch});case 2:if(r=e.sent,c=Object(h.h)(r,t)){e.next=6;break}return e.abrupt("return",null);case 6:return a=Object(h.k)(c,m.d.hasMember),u=null!==(n=Object(h.e)(c,m.c.label))&&void 0!==n?n:"Unknown Name",e.abrupt("return",{id:t,name:u,memberIds:a});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=Object(p.b)("community/getCommunity",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,a,u,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,e.next=3,R(t);case 3:return a=e.sent,u=r(),i=u.user.allIds,a&&a.memberIds.forEach((function(e){i.includes(e)||c(P(e))})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),E=Object(p.b)("community/getCommunitiesOfUser",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,a,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,e.next=3,L(t);case 3:return a=e.sent,u=r(),a.forEach((function(e){u.community.allIds.includes(e)||c(U(e))})),e.abrupt("return",{userId:t,communities:a});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),N=Object(p.c)({name:"community",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(U.fulfilled,(function(e,t){var n=t.payload;n&&(e.byId[n.id]=n,e.allIds.includes(n.id)||e.allIds.push(n.id))}))}}).reducer,P=Object(p.b)("user/fetchUser",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,v(t);case 3:return c=e.sent,r(y(t)),r(E(t)),e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),z=Object(p.c)({name:"user",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(P.fulfilled,(function(e,t){var n=t.payload;n&&(e.byId[n.id]=n,e.allIds.includes(n.id)||e.allIds.push(n.id))})).addCase(E.fulfilled,(function(e,t){var n=t.payload,r=n.userId,c=n.communities;e.byId[r].communityIds=c}))}}).reducer,A=function(e,t){return t},J=Object(j.a)(A,(function(e){return e.user.byId}),(function(e,t){var n;return null!==(n=t[e])&&void 0!==n?n:{id:e,name:"",avatar:"",about:""}})),M=Object(j.a)(A,(function(e){return e.offer.byId}),(function(e,t){return Object.values(t).filter((function(t){return t.userId===e}))})),B=function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.login)({oidcIssuer:t,redirectUrl:globalThis.location.href,clientName:"Open Hospitality Network"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.handleIncomingRedirect)({url:globalThis.location.href,restorePreviousSession:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.logout)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$={webId:"",isLoggedIn:!1,status:"pending"},D=Object(p.b)("login/login",B),F=Object(p.b)("login/init",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,T();case 3:return(null===(c=e.sent)||void 0===c?void 0:c.isLoggedIn)&&(null===c||void 0===c?void 0:c.webId)&&r(P(c.webId)),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),H=Object(p.b)("login/logout",W),_=Object(p.c)({name:"login",initialState:$,reducers:{},extraReducers:function(e){e.addCase(D.pending,(function(e){e.status="pending"})).addCase(D.fulfilled,(function(e){e.status="success"})).addCase(F.fulfilled,(function(e,t){var n,r,c,a;e.status="success",e.webId=null!==(n=null===(r=t.payload)||void 0===r?void 0:r.webId)&&void 0!==n?n:"",e.isLoggedIn=null!==(c=null===(a=t.payload)||void 0===a?void 0:a.isLoggedIn)&&void 0!==c&&c})).addCase(H.fulfilled,(function(e){e.isLoggedIn=$.isLoggedIn,e.status="success",e.webId=$.webId}))}}),q=function(e){return e.login},G=_.reducer,K=n(3),Q=function(){var e=Object(r.useState)("https://solidcommunity.net"),t=Object(d.a)(e,2),n=t[0],c=t[1],a=s();return Object(K.jsxs)("div",{children:[Object(K.jsx)("h1",{children:"Sign in with your Solid Identity"}),Object(K.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a(D(n))},children:[Object(K.jsx)("label",{htmlFor:"provider",children:"Select your Solid Pod Provider"}),Object(K.jsx)("input",{id:"provider",type:"text",value:n,onChange:function(e){return c(e.target.value)}}),Object(K.jsx)("input",{type:"submit",value:"Sign In"})]})]})},V=n(209),X=n(210),Y=n(211),Z=n(212),ee=n(120),te=n.n(ee),ne=(n(204),n(205),function(e){var t=e.points;return Object(K.jsxs)(V.a,{center:[50,15],zoom:10,style:{width:"100vw",height:"100vh"},children:[Object(K.jsx)(X.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(K.jsx)(te.a,{children:t.map((function(e){return Object(K.jsx)(Y.a,{position:e.position,children:Object(K.jsxs)(Z.a,{children:[Object(K.jsx)("p",{children:e.id}),Object(K.jsx)("p",{children:e.userId}),Object(K.jsx)("p",{children:Object.entries(e.about).map((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(K.jsxs)("li",{children:[Object(K.jsx)("b",{children:n})," ",Object(K.jsx)("span",{children:r.join("----")})]},n)}))})]})},e.id)}))})]})}),re=function(){var e=o(S);return Object(K.jsx)(ne,{points:e})},ce=n(61),ae=function(){var e=o(q),t=s();return Object(K.jsxs)("nav",{style:{position:"fixed",top:"1rem",right:"1em",zIndex:500},children:[Object(K.jsx)(ce.b,{to:"/",children:"map"}),Object(K.jsx)("br",{}),Object(K.jsx)(ce.b,{to:"/user/".concat(encodeURIComponent(e.webId)),children:e.webId}),Object(K.jsx)("br",{}),Object(K.jsx)("button",{onClick:function(){return t(H())},children:"Logout"})]})},ue=n(12),ie=function(){var e=Object(ue.f)(),t=decodeURIComponent(e.webId),n=Object(i.c)((function(e){return J(e,t)})),r=Object(i.c)((function(e){return M(e,t)}));return Object(K.jsxs)("div",{children:[Object(K.jsx)("p",{children:Object(K.jsx)("a",{href:n.id,children:n.name})}),Object(K.jsx)("p",{children:Object(K.jsx)("img",{src:n.avatar,alt:"Image of ".concat(n.name)})}),Object(K.jsx)("p",{children:n.about}),Object(K.jsx)("ul",{children:r.map((function(e){return Object(K.jsx)("li",{children:JSON.stringify(e)},e.id)}))})]})};var se=function(){var e=o(q),t=s();return Object(r.useEffect)((function(){t(F())}),[t]),Object(K.jsx)("div",{className:"App",children:Object(K.jsx)("header",{className:"App-header",children:"pending"===e.status?Object(K.jsx)("i",{children:"Loading"}):e.isLoggedIn?Object(K.jsxs)(ce.a,{children:[Object(K.jsx)(ae,{}),Object(K.jsxs)(ue.c,{children:[Object(K.jsx)(ue.a,{path:"/user/:webId",children:Object(K.jsx)(ie,{})}),Object(K.jsx)(ue.a,{path:"/",children:Object(K.jsx)(re,{})})]})]}):Object(K.jsx)(Q,{})})})},oe=Object(p.a)({reducer:{offer:C,community:N,user:z,login:G}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(Object(K.jsx)(c.a.StrictMode,{children:Object(K.jsx)(i.a,{store:oe,children:Object(K.jsx)(se,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[207,1,2]]]);
//# sourceMappingURL=main.762c23c3.chunk.js.map