(this["webpackJsonpohn-solid-client"]=this["webpackJsonpohn-solid-client"]||[]).push([[0],{145:function(e,t,n){},200:function(e,t){},276:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),o=n(51),a=n.n(o),i=(n(145),n(52)),s=function(){return Object(i.c)()},u=i.d,l=n(5),d=n(0),b=n.n(d),f=n(3),j=n(11),p=n(76),m=n(4),h=n(13),x=n(16),O=function(e){return"http://www.w3.org/2003/01/geo/wgs84_pos#"+e},g=function(e){var t;return(null===(t=/^(https:\/\/.*)\/profile\/card#me$/g.exec(e))||void 0===t?void 0:t[1])+"/public/hospex.ttl"},v=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g(t),e.next=3,Object(m.f)(n,{fetch:h.fetch});case 3:return r=e.sent,c=Object(m.k)(r),o=c.map((function(e){return{thing:e,url:Object(m.l)(e,x.b.type)}})).filter((function(e){var t=e.thing,n=e.url;return t&&"https://hospex.example.com/terms/0.1#Accommodation"===n})).map((function(e){return e.thing})).map((function(e){var n,c=Object(m.a)(e),o=Object(m.l)(e,O("location"));if(!o)return null;var a=Object(m.j)(r,o),i=a&&Object(m.e)(a,O("lat")),s=a&&Object(m.e)(a,O("long"));if(null===i||null===s)return null;var u=null!==(n=Object(m.g)(e,x.c.comment))&&void 0!==n?n:"";return{id:c,userId:t,position:[i,s],about:{en:u}}})).filter((function(e){return null!==e})),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,o,a,i,s,u,l,d,f;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.f)(n,{fetch:h.fetch});case 2:return c=e.sent,o="".concat(n,"#location").concat(Date.now()),a=Object(m.b)({url:o}).setUrl(x.b.type,O("Point")).setDecimal(O("lat"),t.position[0]).setDecimal(O("long"),t.position[1]),i=Object(m.b)({url:t.id}).setUrl(x.b.type,"https://hospex.example.com/terms/0.1#Accommodation").setUrl("https://hospex.example.com/terms/0.1#offeredBy",t.userId).setUrl(O("location"),o).setStringWithLocale(x.c.comment,t.about.en,"en"),s=null!==(r=Object(m.j)(c,t.userId))&&void 0!==r?r:Object(m.d)({url:t.userId}),u=Object(m.b)(s).addUrl("https://hospex.example.com/terms/0.1#offers",t.id).build(),l=i.build(),d=a.build(),f=Object(m.p)(c,l),f=Object(m.p)(f,d),f=Object(m.p)(f,u),e.next=15,Object(m.o)(n,f,{fetch:h.fetch});case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,o,a,i,s,u,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.f)(n,{fetch:h.fetch});case 2:if(r=e.sent,!(c=Object(m.j)(r,t.id))){e.next=16;break}if(a=null!==(o=Object(m.l)(c,O("location")))&&void 0!==o?o:"",!(i=Object(m.j)(r,a))){e.next=15;break}return s=Object(m.b)(c).setStringEnglish(x.c.comment,t.about.en),u=Object(m.b)(i).setDecimal(O("lat"),t.position[0]).setDecimal(O("long"),t.position[1]),l=Object(m.p)(r,s.build()),l=Object(m.p)(l,u.build()),e.next=14,Object(m.o)(n,l,{fetch:h.fetch});case 14:return e.abrupt("return",t);case 15:throw new Error("location to update not found");case 16:throw new Error("offer to update not found");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,o,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.f)(t.id,{fetch:h.fetch});case 2:if(n=e.sent,!(r=Object(m.j)(n,t.id))){e.next=11;break}return o=null!==(c=Object(m.l)(r,O("location")))&&void 0!==c?c:"",a=Object(m.n)(n,o),a=Object(m.n)(a,t.id),e.next=10,Object(m.o)(t.id,a,{fetch:h.fetch});case 10:return e.abrupt("return",t);case 11:throw new Error("offer to remove not found");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=Object(j.b)("offer/getOffersOfUser",function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),k=Object(j.b)("offer/create",function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offer,r=t.document,e.next=3,y(n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C=Object(j.b)("offer/update",function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offer,r=t.document,e.next=3,w(n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S=Object(j.b)("offer/remove",function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),E=Object(j.c)({name:"offer",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(N.fulfilled,(function(e,t){t.payload.forEach((function(t){e.byId[t.id]=t,e.allIds.includes(t.id)||e.allIds.push(t.id)}))})).addCase(k.fulfilled,(function(e,t){var n=t.payload;e.byId[n.id]=n,e.allIds.push(n.id)})).addCase(C.fulfilled,(function(e,t){var n=t.payload;e.byId[n.id]=n})).addCase(S.fulfilled,(function(e,t){var n=t.payload;delete e.byId[n.id],e.allIds=e.allIds.filter((function(e){return e!==n.id}))}))}}),L=Object(p.a)((function(e){return e.offer}),(function(e){var t=e.byId;return e.allIds.map((function(e){return t[e]}))})),U=E.reducer,D=n(15),R=n(135),M=n.n(R),A=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,o,a,i,s,u,l,d,f,j,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={id:t,name:"",avatar:"",about:{en:""},communityIds:[],hospexDocuments:[],offerIds:[]},e.next=3,Object(m.f)(t,{fetch:h.fetch});case 3:if(a=e.sent,i=Object(m.j)(a,t)){e.next=7;break}return e.abrupt("return",null);case 7:if(o.name=null!==(n=Object(m.h)(i,x.e.fn)||Object(m.h)(i,x.a.name))&&void 0!==n?n:"",!(s=null!==(r=Object(m.l)(i,x.e.hasPhoto))&&void 0!==r?r:"")){e.next=15;break}return e.next=12,z(s);case 12:e.t0=e.sent,e.next=16;break;case 15:e.t0="";case 16:return o.avatar=e.t0,o.about.en=null!==(c=Object(m.h)(i,x.e.note)||Object(m.i)(i,x.e.note,"en"))&&void 0!==c?c:"",e.prev=18,u=g(t),e.next=22,Object(m.f)(u,{fetch:h.fetch});case 22:l=e.sent,o.hospexDocuments.push(u),(d=Object(m.j)(l,t))&&(o.communityIds=Object(m.m)(d,"https://hospex.example.com/terms/0.1#memberOf"),f=Object(m.m)(d,"https://hospex.example.com/terms/0.1#offers"),j=Object(m.k)(l),p=j.map((function(e){return{thing:e,url:Object(m.l)(e,"https://hospex.example.com/terms/0.1#offeredBy")}})).filter((function(e){return e.url===t})).map((function(e){return e.thing.url})),o.offerIds=M()([].concat(Object(D.a)(f),Object(D.a)(p)))),e.next=31;break;case 28:e.prev=28,e.t1=e.catch(18),e.t1;case 31:return e.abrupt("return",o);case 32:case"end":return e.stop()}}),e,null,[[18,28]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.fetch)(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,c=URL.createObjectURL(r),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(m.f)(t,{fetch:h.fetch});case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Object(m.o)(t,Object(m.c)(),{fetch:h.fetch});case 9:return e.abrupt("return",e.sent);case 10:throw new Error("document already exists");case 11:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,o,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.fetch)(t.groupId,{method:"PATCH",headers:{"Content-Type":"application/sparql-update"},body:"\n        INSERT DATA {\n            <".concat(t.groupId,"> <").concat(x.e.hasMember,"> <").concat(n,"> .\n        }\n    ")});case 2:return r=g(n),e.next=5,Object(m.f)(r,{fetch:h.fetch});case 5:return c=e.sent,o=Object(m.j)(c,n),a=Object(m.b)(null!==o&&void 0!==o?o:Object(m.d)({url:n})).addUrl("https://hospex.example.com/terms/0.1#memberOf",t.id).build(),e.next=10,Object(m.o)(r,Object(m.p)(c,a),{fetch:h.fetch});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),F=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g(t),e.next=3,Object(m.f)(n,{fetch:h.fetch});case 3:if(r=e.sent,c=Object(m.j)(r,t)){e.next=7;break}return e.abrupt("return",[]);case 7:return o=Object(m.m)(c,"https://hospex.example.com/terms/0.1#memberOf"),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r,c,o,a,i,s,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.t1={},e.t2={},e.next=5,z("https://picsum.photos/400");case 5:return e.t3=e.sent,e.t4=[],o={id:e.t0,name:e.t1,about:e.t2,groupId:"",image:e.t3,memberIds:e.t4},e.next=10,Object(m.f)(t,{fetch:h.fetch});case 10:if(a=e.sent,i=Object(m.j)(a,t)){e.next=14;break}throw new Error("Community couldn't be fetched");case 14:return o.name.en=null!==(n=Object(m.g)(i,x.d.name))&&void 0!==n?n:"Unknown Name",o.groupId=null!==(r=Object(m.l)(i,x.d.has_usergroup))&&void 0!==r?r:"",o.about.en=null!==(c=Object(m.g)(i,x.d.about))&&void 0!==c?c:"",e.prev=17,e.next=20,Object(m.f)(o.groupId,{fetch:h.fetch});case 20:s=e.sent,(u=Object(m.j)(s,o.groupId))&&(o.memberIds=Object(m.m)(u,x.e.hasMember)),e.next=28;break;case 25:e.prev=25,e.t5=e.catch(17),console.log(e.t5);case 28:return e.abrupt("return",o);case 29:case"end":return e.stop()}}),e,null,[[17,25]])})));return function(t){return e.apply(this,arguments)}}(),J=Object(j.b)("community/join",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,o,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,o=r(),a=o.login.webId,e.next=5,T(t,a);case 5:return c(W(t.id)),e.abrupt("return",{userId:a,communityId:t.id});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),W=Object(j.b)("community/getCommunity",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,o,a,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,e.next=3,H(t);case 3:return o=e.sent,a=r(),i=a.user.allIds,o&&o.memberIds.forEach((function(e){i.includes(e)||c(K(e))})),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Z=Object(j.b)("community/getCommunitiesOfUser",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c,o,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,e.next=3,F(t);case 3:return o=e.sent,a=r(),o.forEach((function(e){a.community.allIds.includes(e)||c(W(e))})),e.abrupt("return",{userId:t,communities:o});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),B=Object(j.c)({name:"community",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(W.fulfilled,(function(e,t){var n=t.payload;n&&(e.byId[n.id]=n,e.allIds.includes(n.id)||e.allIds.push(n.id))}))}}),q=function(e){return e.community.byId},V=Object(p.a)((function(e){return e.community.allIds}),q,(function(e,t){return e.map((function(e){return t[e]})).filter((function(e){return!!e}))})),$=Object(p.a)((function(e){return e.login.webId}),(function(e){return e.user.byId}),(function(e,t){return t[e]})),_=Object(p.a)($,q,(function(e,t){var n;return null!==(n=null===e||void 0===e?void 0:e.communityIds.map((function(e){return t[e]})).filter((function(e){return!!e})))&&void 0!==n?n:[]})),G=B.reducer,K=Object(j.b)("user/fetchUser",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,A(t);case 3:return(c=e.sent)&&c.hospexDocuments.length>0&&(r(N(t)),r(Z(t))),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Q=Object(j.b)("user/createHospexDocument",function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userId,r=t.documentId,e.next=3,P(r);case 3:return e.abrupt("return",{userId:n,documentId:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),X=Object(j.c)({name:"user",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(K.fulfilled,(function(e,t){var n=t.payload;n&&(e.byId[n.id]=n,e.allIds.includes(n.id)||e.allIds.push(n.id))})).addCase(Z.fulfilled,(function(e,t){var n=t.payload,r=n.userId,c=n.communities;e.byId[r].communityIds=c})).addCase(J.fulfilled,(function(e,t){var n=t.payload,r=n.userId,c=n.communityId;e.byId[r].communityIds.includes(c)||e.byId[r].communityIds.push(c)})).addCase(Q.fulfilled,(function(e,t){var n=t.payload,r=n.userId,c=n.documentId;e.byId[r].hospexDocuments.push(c)}))}}).reducer,Y=function(e,t){return t},ee=Object(p.a)(Y,(function(e){return e.user.byId}),(function(e,t){var n;return null!==(n=t[e])&&void 0!==n?n:{id:e,name:"",avatar:"",about:"",communityIds:[]}})),te=Object(p.a)(Y,(function(e){return e.offer.byId}),(function(e,t){return Object.values(t).filter((function(t){return t.userId===e}))})),ne=Object(p.a)(ee,(function(e){return e.community.byId}),(function(e,t){return Object.values(t).filter((function(t){var n;return(null===e||void 0===e||null===(n=e.communityIds)||void 0===n?void 0:n.includes(t.id))&&t.memberIds.includes(e.id)}))})),re=function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.login)({oidcIssuer:t,redirectUrl:globalThis.location.href,clientName:"Open Hospitality Network"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.handleIncomingRedirect)({url:globalThis.location.href,restorePreviousSession:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.logout)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae={webId:"",isLoggedIn:!1,status:"pending",joinStatus:"pending"},ie=Object(j.b)("login/login",re),se=Object(j.b)("login/init",function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,ce();case 3:return(null===(c=e.sent)||void 0===c?void 0:c.isLoggedIn)&&(null===c||void 0===c?void 0:c.webId)&&r(K(c.webId)),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),ue=Object(j.b)("login/logout",oe),le=Object(j.c)({name:"login",initialState:ae,reducers:{},extraReducers:function(e){e.addCase(ie.pending,(function(e){e.status="pending"})).addCase(ie.fulfilled,(function(e){e.status="success"})).addCase(se.fulfilled,(function(e,t){var n,r,c,o;e.status="success",e.webId=null!==(n=null===(r=t.payload)||void 0===r?void 0:r.webId)&&void 0!==n?n:"",e.isLoggedIn=null!==(c=null===(o=t.payload)||void 0===o?void 0:o.isLoggedIn)&&void 0!==c&&c})).addCase(ue.fulfilled,(function(e){e.isLoggedIn=ae.isLoggedIn,e.status="success",e.webId=ae.webId})).addCase(N.rejected,(function(e){e.joinStatus="new"})).addCase(N.fulfilled,(function(e){e.joinStatus="old"}))}}),de=function(e){return e.login},be=le.reducer,fe=n(1),je=function(){var e=Object(r.useState)("https://solidcommunity.net"),t=Object(l.a)(e,2),n=t[0],c=t[1],o=s();return Object(fe.jsx)("div",{className:"flex flex-col items-center justify-evenly min-h-screen m-5",children:Object(fe.jsxs)("div",{className:"space-y-10",children:[Object(fe.jsxs)("section",{className:"flex flex-col items-center space-y-2",children:[Object(fe.jsxs)("header",{children:[Object(fe.jsx)("h1",{children:"Open Hospitality"}),Object(fe.jsx)("p",{className:"italic",children:"hospitality, decentralized"})]}),Object(fe.jsxs)("div",{className:"w-80 flex items-center justify-evenly",children:[Object(fe.jsx)("a",{href:"https://openhospitality.network",children:Object(fe.jsx)("img",{src:"https://openhospitality.network/assets/img/logo.png",title:"Open Hospitality Network",alt:"Open Hospitality Network logo",className:"h-32"})}),Object(fe.jsx)("span",{className:"text-3xl",children:"+"}),Object(fe.jsx)("a",{href:"https://solidproject.org",children:Object(fe.jsx)("img",{src:"https://avatars3.githubusercontent.com/u/14262490?v=3&s=200",title:"Solid Project",alt:"Solid Project logo",className:"h-32 p-5"})})]})]}),Object(fe.jsxs)("form",{className:"w-96 flex flex-col items-center space-y-2",onSubmit:function(e){e.preventDefault(),o(ie(n))},children:[Object(fe.jsx)("header",{className:"text-xl font-bold",children:"Sign in with your Solid Identity"}),Object(fe.jsx)("label",{htmlFor:"provider",children:"Select your Solid Pod Provider"}),Object(fe.jsx)("input",{className:"rounded border px-2 py-1 w-full",id:"provider",type:"text",value:n,onChange:function(e){return c(e.target.value)}}),Object(fe.jsx)("button",{className:"bg-blue-900 text-blue-50 w-full",type:"submit",children:"Sign In"})]})]})})},pe=(n(263),n(264),n(277)),me=n(278),he=n(279),xe=n(280),Oe=n(136),ge=n.n(Oe),ve=n(46),ye=n(23),we=function(e){var t=e.offer,n=u((function(e){return ee(e,t.userId)}));return Object(fe.jsxs)("div",{children:[Object(fe.jsxs)(ve.b,{to:"/users/".concat(encodeURIComponent(n.id)),className:"flex gap-2 items-center",children:[n.avatar?Object(fe.jsx)("img",{src:n.avatar,className:"h-8 rounded"}):Object(fe.jsx)(ye.g,{className:"h-8"}),n.name]}),Object(fe.jsx)("p",{className:"whitespace-pre-line text-justify w-56",children:t.about.en})]})},Ie=function(e){var t=e.offers;return Object(fe.jsxs)(pe.a,{center:[30,0],zoom:2,className:"w-screen h-screen",children:[Object(fe.jsx)(me.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(fe.jsx)(ge.a,{children:t.map((function(e){return Object(fe.jsx)(he.a,{position:e.position,children:Object(fe.jsx)(xe.a,{children:Object(fe.jsx)(we,{offer:e})})},e.id)}))})]})},Ne=function(){var e=u(L);return Object(fe.jsx)(Ie,{offers:e})},ke=function(){var e=u(de),t=s(),n=[{type:"link",to:"/",title:"map",icon:ye.c},{type:"link",to:"/users/".concat(encodeURIComponent(e.webId)),title:"my profile",icon:ye.g},{type:"link",to:"/offers",title:"my offers",icon:ye.b},{type:"link",to:"/communities",title:"communities",icon:ye.h},{type:"button",onClick:function(){return t(ue())},title:"sign out",icon:ye.e}];return Object(fe.jsx)("nav",{className:"fixed top-4 right-4 z-500 flex items-center gap-0 bg-opacity-50 bg-white text-gray-400 rounded",children:n.map((function(e){var t=Object(fe.jsx)(e.icon,{title:e.title,className:"text-4xl p-2"}),n="p-0 hover:text-white hover:bg-opacity-100 hover:bg-black rounded";return"link"===e.type?Object(fe.jsx)(ve.b,{className:n,to:e.to,children:t},e.title):Object(fe.jsx)("button",{className:n,onClick:e.onClick,children:t},e.title)}))})},Ce=n(12),Se=[{hoverbg100:"hover:bg-red-100",bg200:"bg-red-200",bg300:"bg-red-300",text900:"text-red-900"},{hoverbg100:"hover:bg-yellow-100",bg200:"bg-yellow-200",bg300:"bg-yellow-300",text900:"text-yellow-900"},{hoverbg100:"hover:bg-green-100",bg200:"bg-green-200",bg300:"bg-green-300",text900:"text-green-900"},{hoverbg100:"hover:bg-blue-100",bg200:"bg-blue-200",bg300:"bg-blue-300",text900:"text-blue-900"},{hoverbg100:"hover:bg-indigo-100",bg200:"bg-indigo-200",bg300:"bg-indigo-300",text900:"text-indigo-900"},{hoverbg100:"hover:bg-purple-100",bg200:"bg-purple-200",bg300:"bg-purple-300",text900:"text-purple-900"},{hoverbg100:"hover:bg-pink-100",bg200:"bg-pink-200",bg300:"bg-pink-300",text900:"text-pink-900"}],Ee=function(e){var t=e.community,n=e.isMember,c=e.onJoin,o=Object(r.useState)(Se[Math.floor(Math.random()*Se.length)]),a=Object(l.a)(o,1)[0];return Object(fe.jsxs)("div",{className:"w-64 p-4 ".concat(a.bg300," rounded flex flex-col gap-4"),children:[Object(fe.jsx)("header",{style:{backgroundImage:'url("'.concat(t.image,'")'),textShadow:"0 0 5px white"},className:"py-16 text-center -m-4 rounded-t bg-cover bg-center text-xl font-bold",children:t.name.en}),Object(fe.jsx)("section",{className:"mt-2 whitespace-pre-line text-justify",children:t.about.en}),n?Object(fe.jsx)("div",{className:"text-center",children:"Member"}):Object(fe.jsx)("button",{className:"".concat(a.bg200," ").concat(a.hoverbg100," ").concat(a.text900),onClick:c,children:"Join"})]})},Le=n(47),Ue=n(281),De=n(78),Re=n.n(De),Me=function(e){var t=e.confirmString,n=e.onConfirm,c=e.onCancel,o=Object(r.useState)(!0),a=Object(l.a)(o,2),i=a[0],s=a[1],u=Object(r.useState)(""),d=Object(l.a)(u,2),b=d[0],f=d[1];return Object(fe.jsxs)(Re.a,{isOpen:i,onRequestClose:function(){return s(!1)},onAfterClose:c,contentLabel:"Are you sure?",closeTimeoutMS:150,overlayClassName:{base:"bg-opacity-90 bg-gray-900 fixed top-0 left-0 bottom-0 right-0 z-5000",afterOpen:"",beforeClose:""},children:[Object(fe.jsx)("h1",{children:"Are you sure you want to remove offer?"}),Object(fe.jsxs)("form",{onSubmit:function(e){e.preventDefault(),b===t&&n()},className:"flex flex-col gap-2",children:[Object(fe.jsxs)("label",{children:["Please enter"," ",Object(fe.jsx)("samp",{children:Object(fe.jsx)("kbd",{children:t})})," ","below"]}),Object(fe.jsx)("input",{className:"border rounded",type:"text",value:b,onChange:function(e){return f(e.target.value)},autoFocus:!0}),Object(fe.jsx)("button",{type:"submit",disabled:t!==b,className:"disabled:opacity-50 bg-red-400 disabled:cursor-not-allowed cursor-pointer",children:"Confirm"}),Object(fe.jsx)("button",{className:"border",onClick:c,children:"Cancel"})]})]})},Ae=["offer","editable"],ze=function(e){var t=e.offer,n=e.editable,c=void 0!==n&&n,o=Object(Le.a)(e,Ae),a=s(),i=Object(r.useState)(!1),u=Object(l.a)(i,2),d=u[0],b=u[1];return Object(fe.jsxs)("div",{className:"w-64 p-4 bg-blue-50 rounded flex flex-col gap-4",children:[Object(fe.jsx)(Te,{location:t.position,className:"w-56 h-56"}),Object(fe.jsx)("section",{className:"whitespace-pre-line text-justify",children:t.about.en}),c&&"onClickEdit"in o&&Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("button",{className:"bg-white",onClick:o.onClickEdit,children:"edit"}),Object(fe.jsx)("button",{className:"bg-red-400",onClick:function(){return b(!0)},children:"remove"}),d&&Object(fe.jsx)(Me,{confirmString:new globalThis.URL(t.id).hash,onConfirm:function(){a(S(t)),b(!1)},onCancel:function(){return b(!1)}})]})]})},Pe=function(e){var t=e.location,n=Object(Ue.a)();return Object(r.useEffect)((function(){n.setView(t,12)}),[t,n]),null},Te=function(e){var t=e.location,n=e.className,r=void 0===n?"":n;return Object(fe.jsxs)(pe.a,{attributionControl:!1,center:t,zoom:12,scrollWheelZoom:"center",doubleClickZoom:"center",touchZoom:"center",className:r,children:[Object(fe.jsx)(Pe,{location:t}),Object(fe.jsx)(me.a,{url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(fe.jsx)(he.a,{position:t})]})},Fe=function(){var e=Object(Ce.g)(),t=decodeURIComponent(e.webId),n=u((function(e){return ee(e,t)})),r=u((function(e){return te(e,t)})),c=u($),o=u((function(e){return ne(e,t)})),a=s();return Object(fe.jsxs)("div",{className:"flex flex-col items-center gap-4 my-8",children:[Object(fe.jsxs)("header",{className:"flex items-center gap-2",children:[Object(fe.jsxs)("h1",{className:"italic",children:["Profile of ",Object(fe.jsx)("span",{className:"not-italic",children:n.name})]})," ",Object(fe.jsx)("a",{href:n.id,children:Object(fe.jsx)(ye.a,{className:"text-xs text-gray-400 hover:text-gray-800"})})]}),n.avatar&&Object(fe.jsx)("img",{className:"w-56 max-h-56",src:n.avatar,alt:"image of ".concat(n.name)}),Object(fe.jsx)("p",{className:"w-56 whitespace-pre-line text-justify",children:n.about.en||Object(fe.jsx)("span",{className:"text-gray-500 italic",children:"This user has no description"})}),Object(fe.jsxs)("h2",{children:["Offers (",r.length,")"]}),Object(fe.jsx)("section",{children:Object(fe.jsx)("ul",{className:"flex flex-wrap gap-6 justify-center",children:r.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsx)(ze,{offer:e})},e.id)}))})}),Object(fe.jsxs)("h2",{children:["Communities (",o.length,")"]}),Object(fe.jsx)("section",{children:Object(fe.jsx)("ul",{className:"flex flex-wrap gap-6 justify-center",children:o.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsx)(Ee,{community:e,isMember:c.communityIds.includes(e.id)&&e.memberIds.includes(c.id),onJoin:function(){return a(J(e))}})},e.id)}))})})]})},He=n(20),Je=function(e){var t,n=e.offer,c=e.onSubmit,o=e.onCancel,a=e.submit,i=Object(r.useState)(n),s=Object(l.a)(i,2),u=s[0],d=s[1];Object(r.useEffect)((function(){d(n)}),[n]);return Object(fe.jsxs)("form",{className:"w-64 p-4 bg-blue-200 rounded flex flex-col gap-4",onSubmit:function(e){e.preventDefault(),c(u)},children:[Object(fe.jsx)(qe,{location:u.position,onChange:function(e){d((function(t){return Object(He.a)(Object(He.a)({},t),{},{position:e})}))},className:"w-56 h-56"}),Object(fe.jsx)("textarea",{className:"h-40 p-1",value:null!==(t=u.about.en)&&void 0!==t?t:"",onChange:function(e){d((function(t){return Object(He.a)(Object(He.a)({},t),{},{about:{en:e.target.value}})}))},placeholder:"What can you and your place offer to guests?"}),Object(fe.jsx)("button",{className:"bg-green-300 hover:bg-green-400",type:"submit",children:a}),Object(fe.jsx)("button",{className:"hover:bg-gray-100",type:"button",onClick:o,children:"Cancel"})]})},We=function(e){return(e%360-540)%360+180},Ze=function(e){var t=e.onDrag,n=Object(Ue.b)("drag",(function(){var e=n.getCenter(),r=e.lat,c=e.lng;t([r,We(c)]),n.setView([r,We(c)])}));return null},Be=function(e){var t=e.onLocationFound,n=Object(Ue.b)("locationfound",(function(e){var r=e.latlng,c=r.lat,o=r.lng;t([c,o]),n.flyTo([c,We(o)])}));return null},qe=function(e){var t=e.location,n=e.className,c=void 0===n?"":n,o=e.onChange,a=Object(r.useState)(),i=Object(l.a)(a,2),s=i[0],u=i[1];return Object(fe.jsxs)("div",{children:[Object(fe.jsxs)("section",{className:"bg-yellow-200 p-2 text-sm italic",children:["drag map to a new location or"," ",Object(fe.jsx)("button",{className:"bg-yellow-50",type:"button",onClick:function(){return null===s||void 0===s?void 0:s.locate()},children:"find your location"})]}),Object(fe.jsxs)(pe.a,{attributionControl:!1,center:t,zoom:12,scrollWheelZoom:"center",doubleClickZoom:"center",touchZoom:"center",className:c,whenCreated:u,children:[Object(fe.jsx)(Be,{onLocationFound:o}),Object(fe.jsx)(Ze,{onDrag:o}),Object(fe.jsx)(me.a,{url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(fe.jsx)(he.a,{position:t})]})]})},Ve=function(){var e,t=u($),n=u(de).webId,c=u((function(e){return te(e,n)})),o=s(),a=g(n),i=Object(r.useState)(!1),d=Object(l.a)(i,2),b=d[0],f=d[1],j=Object(r.useState)(""),p=Object(l.a)(j,2),m=p[0],h=p[1],x=c.find((function(e){return e.id===m})),O=function(e){o(C({offer:e,document:a})),h("")},v=function(){f(!1),h("")};return Object(fe.jsxs)("div",{className:"flex flex-col items-center justify-evenly my-8",children:[Object(fe.jsx)("header",{children:Object(fe.jsxs)("h1",{children:["Offers of"," ",Object(fe.jsx)(ve.b,{to:"/users/".concat(encodeURIComponent(n)),children:null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:"user"})]})}),Object(fe.jsxs)("ul",{className:"flex flex-wrap gap-6 justify-center",children:[c.map((function(e){return Object(fe.jsx)("li",{children:e===x?Object(fe.jsx)(Je,{offer:x,onSubmit:O,onCancel:v,submit:"Update"}):Object(fe.jsx)(ze,{offer:e,editable:!0,onClickEdit:function(){return t=e.id,h(""),f(!1),void h(t);var t}})},e.id)})),Object(fe.jsx)("li",{children:b?Object(fe.jsx)(Je,{offer:{id:"".concat(a,"#offer").concat(Date.now()),userId:n,position:[51.477,0],about:{en:""}},onSubmit:function(e){o(k({offer:e,document:a})),f(!1)},onCancel:v,submit:"Create"}):m?null:Object(fe.jsx)("button",{className:"w-64 h-64 p-4 bg-blue-400 rounded flex items-center justify-center text-5xl font-bold text-indigo-50",onClick:function(){f(!0),h("")},children:"+ Add"})})]})]})},$e=function(){var e=u(V),t=u(_),n=u($),r=s();return Object(fe.jsxs)("div",{className:"flex flex-col items-center justify-evenly my-8",children:[Object(fe.jsx)("header",{children:Object(fe.jsx)("h1",{children:"Communities"})}),Object(fe.jsx)("ul",{className:"flex flex-wrap gap-6 justify-center",children:e.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsx)(Ee,{community:e,isMember:t.includes(e)&&e.memberIds.includes(n.id),onJoin:function(){return r(J(e))}},e.id)},e.id)}))})]})},_e=function(e){var t=e.message,n=void 0===t?"Loading":t;return Object(fe.jsx)("div",{className:"flex items-center justify-center h-screen w-screen",children:n})},Ge=Object(j.c)({name:"onboarding",initialState:{onboarding:!1,step:0},reducers:{setOnboarding:function(e,t){e.onboarding=t.payload},incrementStep:function(e){e.step++},decrementStep:function(e){e.step--},setStep:function(e,t){e.step=t.payload}}}),Ke=Ge.actions,Qe=Ke.setOnboarding,Xe=Ke.incrementStep,Ye=Ke.decrementStep,et=(Ke.setStep,function(e){return e.onboarding}),tt=Ge.reducer,nt=function(){var e=s(),t=u(de),n=g(t.webId);return Object(fe.jsxs)("div",{className:"h-screen flex flex-col items-center justify-center gap-4",children:[Object(fe.jsx)("h1",{children:"It's your first time..."}),Object(fe.jsx)("button",{className:"bg-yellow-500",onClick:function(){e(Qe(!0)),e(Q({documentId:n,userId:t.webId}))},children:"Let's get started!"})]})},rt=function(){var e=u(et),t=s(),n=u(de),c=Object(Ce.f)(),o=Object(r.useMemo)((function(){return[{url:"/communities",text:"Join some communities so you can meet people"},{url:"/users/".concat(encodeURIComponent(n.webId)),text:"Edit your profile"},{url:"/offers",text:"If you can, offer hosting to others"},{url:"/",text:"Map is where you can find Hosts"}]}),[n.webId]);return Object(r.useEffect)((function(){c.replace(o[e.step].url)}),[c,e.step,o]),e.onboarding?Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsxs)("div",{className:"h-32 w-screen z-2000 fixed flex flex-col items-center justify-evenly bg-purple-400",children:[Object(fe.jsx)("div",{className:"flex gap-1",children:[0,1,2,3].map((function(t){return Object(fe.jsx)("div",{className:"".concat(t<=e.step?"bg-purple-300":"bg-purple-50"," h-2 w-2 rounded-full")},t)}))}),Object(fe.jsx)("div",{children:o[e.step].text}),Object(fe.jsxs)("div",{className:"flex justify-evenly w-full",children:[e.step>0&&Object(fe.jsx)("button",{className:"bg-purple-300 hover:bg-purple-50",onClick:function(){return t(Ye())},children:"Back"}),e.step<o.length-1&&Object(fe.jsx)("button",{className:"bg-purple-300 hover:bg-purple-50",onClick:function(){return t(Xe())},children:"Next"}),e.step===o.length-1&&Object(fe.jsx)("button",{className:"bg-purple-300 hover:bg-purple-50",onClick:function(){return t(Qe(!1))},children:"Finish"})]})]}),Object(fe.jsx)("div",{className:"h-32"})]}):null};var ct=function(){var e=u(de),t=s(),n=u($);return Object(r.useEffect)((function(){t(se())}),[t]),Object(r.useEffect)((function(){e.isLoggedIn&&["https://mrkvon.inrupt.net/hospex/sleepy-bike/community#us"].forEach((function(e){t(W(e))}))}),[e.isLoggedIn,t]),"pending"===e.status?Object(fe.jsx)(_e,{message:"Initializing..."}):e.isLoggedIn?n?0===n.hospexDocuments.length?Object(fe.jsx)(nt,{}):Object(fe.jsx)("div",{className:"App",children:Object(fe.jsxs)(ve.a,{children:[Object(fe.jsx)(rt,{}),Object(fe.jsx)(ke,{}),Object(fe.jsxs)(Ce.c,{children:[Object(fe.jsx)(Ce.a,{path:"/users/:webId",children:Object(fe.jsx)(Fe,{})}),Object(fe.jsx)(Ce.a,{path:"/offers",children:Object(fe.jsx)(Ve,{})}),Object(fe.jsx)(Ce.a,{path:"/communities",children:Object(fe.jsx)($e,{})}),Object(fe.jsx)(Ce.a,{path:"/",children:Object(fe.jsx)(Ne,{})})]})]})}):Object(fe.jsx)(_e,{message:"Fetching your profile..."}):Object(fe.jsx)(je,{})},ot={type:"",title:"",detail:""},at=Object(j.c)({name:"notification",initialState:ot,reducers:{setNotification:function(e,t){return t.payload},clearNotification:function(){return ot}},extraReducers:function(e){return e.addMatcher(j.d,(function(e,t){var n,r,c;return{type:"error",title:(null!==(n=null!==(r=t.error.code)&&void 0!==r?r:" "+t.error.name)&&void 0!==n?n:"").trim(),detail:null!==(c=t.error.message)&&void 0!==c?c:""}}))}}),it=at.actions,st=it.setNotification,ut=it.clearNotification,lt=function(e){return e.notification},dt=at.reducer,bt=Object(j.a)({reducer:{offer:U,community:G,user:X,login:be,onboarding:tt,notification:dt}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ft=function(){var e=u(lt);return""===e.type?null:Object(fe.jsx)(jt,{notification:e})},jt=function(e){var t=e.notification,n=s(),c=Object(r.useMemo)((function(){return function(e){"Escape"===e.key&&(console.log(e.key),e.stopPropagation(),n(ut()))}}),[n]);Object(r.useEffect)((function(){return document.addEventListener("keydown",c,!1),function(){document.removeEventListener("keydown",c,!1)}}),[c]);var o="error"===t.type?"bg-red-500":"success"===t.type?"bg-green-500":"bg-yellow-500";return Object(fe.jsxs)("div",{tabIndex:0,title:"click to close",className:"".concat(o," p-4 fixed z-5000 bottom-0 bg-opacity-80 hover:bg-opacity-90 rounded-none max-h-screen w-full overflow-auto"),children:[Object(fe.jsx)("button",{className:"absolute top-3 right-3 p-1 rounded-full ".concat(o),onClick:function(){return n(ut())},children:Object(fe.jsx)(ye.f,{})}),Object(fe.jsx)("header",{children:t.title}),Object(fe.jsx)("section",{children:Object(fe.jsx)("pre",{children:t.detail})})]})},pt=n(33),mt=n(64),ht=n(34),xt=n(35),Ot=function(e){Object(ht.a)(n,e);var t=Object(xt.a)(n);function n(){var e;Object(pt.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(mt.a)(n,[{key:"componentDidCatch",value:function(e){this.setState({hasError:!0}),this.props.setNotification({type:"error",title:e.constructor.name,detail:e.message})}},{key:"render",value:function(){return this.state.hasError?Object(fe.jsxs)("div",{className:"w-screen h-screen flex flex-col items-center justify-evenly font-bold text-2xl text-center",children:[Object(fe.jsx)(ye.d,{className:"text-5xl text-indigo-700"}),Object(fe.jsxs)("p",{children:["Sorry, something went terribly wrong.",Object(fe.jsx)("br",{}),"Please, let us know.",Object(fe.jsx)("br",{}),"And reload..."]})]}):this.props.children}}]),n}(c.a.Component),gt=Object(i.b)(null,{setNotification:st})(Ot);Re.a.setAppElement("#root"),a.a.render(Object(fe.jsx)(c.a.StrictMode,{children:Object(fe.jsxs)(i.a,{store:bt,children:[Object(fe.jsx)(gt,{children:Object(fe.jsx)(ct,{})}),Object(fe.jsx)(ft,{})]})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[276,1,2]]]);
//# sourceMappingURL=main.424f03a4.chunk.js.map