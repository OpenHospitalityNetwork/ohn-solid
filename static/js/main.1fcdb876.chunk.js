(this["webpackJsonpohn-solid-client"]=this["webpackJsonpohn-solid-client"]||[]).push([[0],{136:function(e,t,n){},191:function(e,t){},222:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(51),o=n.n(a),i=(n(136),n(62)),s=function(){return Object(i.b)()},u=i.c,l=n(5),b=n(0),d=n.n(b),f=n(3),j=n(14),p=n(71),h=n(4),m=n(12),x=n(15),O=function(e){return"http://www.w3.org/2003/01/geo/wgs84_pos#"+e},g=function(e){var t;return(null===(t=/^(https:\/\/.*)\/profile\/card#me$/g.exec(e))||void 0===t?void 0:t[1])+"/public/hospex.ttl"},v=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g(t),e.next=3,Object(h.f)(n,{fetch:m.fetch});case 3:return r=e.sent,c=Object(h.k)(r),a=c.map((function(e){return{thing:e,url:Object(h.l)(e,x.b.type)}})).filter((function(e){var t=e.thing,n=e.url;return t&&"https://hospex.example.com/terms/0.1#Accommodation"===n})).map((function(e){return e.thing})).map((function(e){var n,c=Object(h.a)(e),a=Object(h.l)(e,O("location"));if(!a)return null;var o=Object(h.j)(r,a),i=o&&Object(h.e)(o,O("lat")),s=o&&Object(h.e)(o,O("long"));if(null===i||null===s)return null;var u=null!==(n=Object(h.g)(e,x.c.comment))&&void 0!==n?n:"";return{id:c,userId:t,position:[i,s],about:{en:u}}})).filter((function(e){return null!==e})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(h.f)(t,{fetch:m.fetch});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Object(h.o)(t,Object(h.c)(),{fetch:m.fetch});case 9:throw new Error("document already exists");case 10:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o,i,s,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.f)(n,{fetch:m.fetch});case 2:return r=e.sent,c="".concat(n,"#location").concat(Date.now()),a=Object(h.b)({url:c}).setUrl(x.b.type,O("Point")).setDecimal(O("lat"),t.position[0]).setDecimal(O("long"),t.position[1]),o=Object(h.b)({url:t.id}).setUrl(x.b.type,"https://hospex.example.com/terms/0.1#Accommodation").setUrl("https://hospex.example.com/terms/0.1#offeredBy",t.userId).setUrl(O("location"),c).setStringWithLocale(x.c.comment,t.about.en,"en"),i=o.build(),s=a.build(),u=Object(h.p)(r,i),u=Object(h.p)(u,s),e.next=12,Object(h.o)(n,u,{fetch:m.fetch});case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o,i,s,u,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.f)(n,{fetch:m.fetch});case 2:if(r=e.sent,!(c=Object(h.j)(r,t.id))){e.next=16;break}if(o=null!==(a=Object(h.l)(c,O("location")))&&void 0!==a?a:"",!(i=Object(h.j)(r,o))){e.next=15;break}return s=Object(h.b)(c).setStringEnglish(x.c.comment,t.about.en),u=Object(h.b)(i).setDecimal(O("lat"),t.position[0]).setDecimal(O("long"),t.position[1]),l=Object(h.p)(r,s.build()),l=Object(h.p)(l,u.build()),e.next=14,Object(h.o)(n,l,{fetch:m.fetch});case 14:return e.abrupt("return",t);case 15:throw new Error("location to update not found");case 16:throw new Error("offer to update not found");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c,a,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.f)(t.id,{fetch:m.fetch});case 2:if(n=e.sent,!(r=Object(h.j)(n,t.id))){e.next=11;break}return a=null!==(c=Object(h.l)(r,O("location")))&&void 0!==c?c:"",o=Object(h.n)(n,a),o=Object(h.n)(o,t.id),e.next=10,Object(h.o)(t.id,o,{fetch:m.fetch});case 10:return e.abrupt("return",t);case 11:throw new Error("offer to remove not found");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=Object(j.b)("offer/getOffersOfUser",function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.next=10,y(g(t));case 10:throw e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()),C=Object(j.b)("offer/create",function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offer,r=t.document,e.next=3,w(n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S=Object(j.b)("offer/update",function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offer,r=t.document,e.next=3,I(n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),E=Object(j.b)("offer/remove",function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=Object(j.c)({name:"offer",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(N.fulfilled,(function(e,t){t.payload.forEach((function(t){e.byId[t.id]=t,e.allIds.includes(t.id)||e.allIds.push(t.id)}))})).addCase(C.fulfilled,(function(e,t){var n=t.payload;e.byId[n.id]=n,e.allIds.push(n.id)})).addCase(S.fulfilled,(function(e,t){var n=t.payload;e.byId[n.id]=n})).addCase(E.fulfilled,(function(e,t){var n=t.payload;delete e.byId[n.id],e.allIds=e.allIds.filter((function(e){return e!==n.id}))}))}}),L=Object(p.a)((function(e){return e.offer}),(function(e){var t=e.byId;return e.allIds.map((function(e){return t[e]}))})),R=U.reducer,D=function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(m.fetch)(t.groupId,{method:"PATCH",headers:{"Content-Type":"application/sparql-update"},body:"\n        INSERT DATA {\n            <".concat(t.groupId,"> <").concat(x.e.hasMember,"> <").concat(n,"> .\n        }\n    ")}),r=g(n),e.next=4,Object(h.f)(r,{fetch:m.fetch});case 4:return c=e.sent,a=Object(h.j)(c,n),o=Object(h.b)(null!==a&&void 0!==a?a:Object(h.d)({url:n})).addUrl("https://hospex.example.com/terms/0.1#memberOf",t.id).build(),e.next=9,Object(h.o)(r,Object(h.p)(c,o),{fetch:m.fetch});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g(t),e.next=3,Object(h.f)(n,{fetch:m.fetch});case 3:if(r=e.sent,c=Object(h.j)(r,t)){e.next=7;break}return e.abrupt("return",[]);case 7:return a=Object(h.m)(c,"https://hospex.example.com/terms/0.1#memberOf"),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c,a,o,i,s,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t,name:{},about:{},groupId:"",image:"https://picsum.photos/400",memberIds:[]},e.next=3,Object(h.f)(t,{fetch:m.fetch});case 3:if(o=e.sent,i=Object(h.j)(o,t)){e.next=7;break}throw new Error("Community couldn't be fetched");case 7:return a.name.en=null!==(n=Object(h.g)(i,x.d.name))&&void 0!==n?n:"Unknown Name",a.groupId=null!==(r=Object(h.l)(i,x.d.has_usergroup))&&void 0!==r?r:"",a.about.en=null!==(c=Object(h.g)(i,x.d.about))&&void 0!==c?c:"",e.prev=10,e.next=13,Object(h.f)(a.groupId,{fetch:m.fetch});case 13:s=e.sent,(u=Object(h.j)(s,a.groupId))&&(a.memberIds=Object(h.m)(u,x.e.hasMember)),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(10),console.log(e.t0);case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}}),e,null,[[10,18]])})));return function(t){return e.apply(this,arguments)}}(),P=Object(j.b)("community/join",function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,a=r(),o=a.login.webId,e.next=5,D(t,o);case 5:return c(T(t.id)),e.abrupt("return",{userId:o,communityId:t.id});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),T=Object(j.b)("community/getCommunity",function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,e.next=3,M(t);case 3:return a=e.sent,o=r(),i=o.user.allIds,a&&a.memberIds.forEach((function(e){i.includes(e)||c($(e))})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),z=Object(j.b)("community/getCommunitiesOfUser",function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,c=n.dispatch,e.next=3,A(t);case 3:return a=e.sent,o=r(),a.forEach((function(e){o.community.allIds.includes(e)||c(T(e))})),e.abrupt("return",{userId:t,communities:a});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),J=Object(j.c)({name:"community",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase(T.fulfilled,(function(e,t){var n=t.payload;n&&(e.byId[n.id]=n,e.allIds.includes(n.id)||e.allIds.push(n.id))}))}}),W=function(e){return e.community.byId},Z=Object(p.a)((function(e){return e.community.allIds}),W,(function(e,t){return e.map((function(e){return t[e]})).filter((function(e){return!!e}))})),F=Object(p.a)((function(e){return e.login.webId}),(function(e){return e.user.byId}),(function(e,t){return t[e]})),H=Object(p.a)(F,W,(function(e,t){var n;return null!==(n=null===e||void 0===e?void 0:e.communityIds.map((function(e){return t[e]})).filter((function(e){return!!e})))&&void 0!==n?n:[]})),B=J.reducer,q=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c,a,o,i,s,u,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.f)(t,{fetch:m.fetch});case 2:if(a=e.sent,o=Object(h.j)(a,t)){e.next=6;break}return e.abrupt("return",null);case 6:if(i=null!==(n=Object(h.h)(o,x.e.fn)||Object(h.h)(o,x.a.name))&&void 0!==n?n:"",!(s=null!==(r=Object(h.l)(o,x.e.hasPhoto))&&void 0!==r?r:"")){e.next=14;break}return e.next=11,V(s);case 11:e.t0=e.sent,e.next=15;break;case 14:e.t0="";case 15:return u=e.t0,l=null!==(c=Object(h.h)(o,x.e.note)||Object(h.i)(o,x.e.note,"en"))&&void 0!==c?c:"",e.abrupt("return",{id:t,name:i,avatar:u,about:{en:l},communityIds:[]});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.fetch)(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,c=URL.createObjectURL(r),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=Object(j.b)("user/fetchUser",function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,q(t);case 3:return c=e.sent,r(N(t)),r(z(t)),e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),_=Object(j.c)({name:"user",initialState:{byId:{},allIds:[]},reducers:{},extraReducers:function(e){e.addCase($.fulfilled,(function(e,t){var n=t.payload;n&&(e.byId[n.id]=n,e.allIds.includes(n.id)||e.allIds.push(n.id))})).addCase(z.fulfilled,(function(e,t){var n=t.payload,r=n.userId,c=n.communities;e.byId[r].communityIds=c})).addCase(P.fulfilled,(function(e,t){var n=t.payload,r=n.userId,c=n.communityId;e.byId[r].communityIds.includes(c)||e.byId[r].communityIds.push(c)}))}}).reducer,G=function(e,t){return t},K=Object(p.a)(G,(function(e){return e.user.byId}),(function(e,t){var n;return null!==(n=t[e])&&void 0!==n?n:{id:e,name:"",avatar:"",about:"",communityIds:[]}})),Q=Object(p.a)(G,(function(e){return e.offer.byId}),(function(e,t){return Object.values(t).filter((function(t){return t.userId===e}))})),X=Object(p.a)(K,(function(e){return e.community.byId}),(function(e,t){return Object.values(t).filter((function(t){var n;return(null===e||void 0===e||null===(n=e.communityIds)||void 0===n?void 0:n.includes(t.id))&&t.memberIds.includes(e.id)}))})),Y=function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.login)({oidcIssuer:t,redirectUrl:globalThis.location.href,clientName:"Open Hospitality Network"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.handleIncomingRedirect)({url:globalThis.location.href,restorePreviousSession:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.logout)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne={webId:"",isLoggedIn:!1,status:"pending",joinStatus:"pending"},re=Object(j.b)("login/login",Y),ce=Object(j.b)("login/init",function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,ee();case 3:return(null===(c=e.sent)||void 0===c?void 0:c.isLoggedIn)&&(null===c||void 0===c?void 0:c.webId)&&r($(c.webId)),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),ae=Object(j.b)("login/logout",te),oe=Object(j.c)({name:"login",initialState:ne,reducers:{},extraReducers:function(e){e.addCase(re.pending,(function(e){e.status="pending"})).addCase(re.fulfilled,(function(e){e.status="success"})).addCase(ce.fulfilled,(function(e,t){var n,r,c,a;e.status="success",e.webId=null!==(n=null===(r=t.payload)||void 0===r?void 0:r.webId)&&void 0!==n?n:"",e.isLoggedIn=null!==(c=null===(a=t.payload)||void 0===a?void 0:a.isLoggedIn)&&void 0!==c&&c})).addCase(ae.fulfilled,(function(e){e.isLoggedIn=ne.isLoggedIn,e.status="success",e.webId=ne.webId})).addCase(N.rejected,(function(e){e.joinStatus="new"})).addCase(N.fulfilled,(function(e){e.joinStatus="old"}))}}),ie=function(e){return e.login},se=oe.reducer,ue=n(2),le=function(){var e=Object(r.useState)("https://solidcommunity.net"),t=Object(l.a)(e,2),n=t[0],c=t[1],a=s();return Object(ue.jsx)("div",{className:"flex flex-col items-center justify-evenly min-h-screen m-5",children:Object(ue.jsxs)("div",{className:"space-y-10",children:[Object(ue.jsxs)("section",{className:"flex flex-col items-center space-y-2",children:[Object(ue.jsxs)("header",{children:[Object(ue.jsx)("h1",{children:"Open Hospitality"}),Object(ue.jsx)("p",{className:"italic",children:"hospitality, decentralized"})]}),Object(ue.jsxs)("div",{className:"w-80 flex items-center justify-evenly",children:[Object(ue.jsx)("a",{href:"https://openhospitality.network",children:Object(ue.jsx)("img",{src:"https://openhospitality.network/assets/img/logo.png",title:"Open Hospitality Network",alt:"Open Hospitality Network logo",className:"h-32"})}),Object(ue.jsx)("span",{className:"text-3xl",children:"+"}),Object(ue.jsx)("a",{href:"https://solidproject.org",children:Object(ue.jsx)("img",{src:"https://avatars3.githubusercontent.com/u/14262490?v=3&s=200",title:"Solid Project",alt:"Solid Project logo",className:"h-32 p-5"})})]})]}),Object(ue.jsxs)("form",{className:"w-96 flex flex-col items-center space-y-2",onSubmit:function(e){e.preventDefault(),a(re(n))},children:[Object(ue.jsx)("header",{className:"text-xl font-bold",children:"Sign in with your Solid Identity"}),Object(ue.jsx)("label",{htmlFor:"provider",children:"Select your Solid Pod Provider"}),Object(ue.jsx)("input",{className:"rounded border px-2 py-1 w-full",id:"provider",type:"text",value:n,onChange:function(e){return c(e.target.value)}}),Object(ue.jsx)("button",{className:"bg-blue-900 text-blue-50 w-full",type:"submit",children:"Sign In"})]})]})})},be=(n(209),n(210),n(223)),de=n(224),fe=n(225),je=n(226),pe=n(127),he=n.n(pe),me=n(46),xe=n(33),Oe=function(e){var t=e.offer,n=u((function(e){return K(e,t.userId)}));return Object(ue.jsxs)("div",{children:[Object(ue.jsxs)(me.b,{to:"/users/".concat(encodeURIComponent(n.id)),className:"flex gap-2 items-center",children:[n.avatar?Object(ue.jsx)("img",{src:n.avatar,className:"h-8 rounded"}):Object(ue.jsx)(xe.e,{className:"h-8"}),n.name]}),Object(ue.jsx)("p",{className:"whitespace-pre-line text-justify w-56",children:t.about.en})]})},ge=function(e){var t=e.offers;return Object(ue.jsxs)(be.a,{center:[30,0],zoom:2,className:"w-screen h-screen",children:[Object(ue.jsx)(de.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(ue.jsx)(he.a,{children:t.map((function(e){return Object(ue.jsx)(fe.a,{position:e.position,children:Object(ue.jsx)(je.a,{children:Object(ue.jsx)(Oe,{offer:e})})},e.id)}))})]})},ve=function(){var e=u(L);return Object(ue.jsx)(ge,{offers:e})},ye=function(){var e=u(ie),t=s(),n=[{type:"link",to:"/",title:"map",icon:xe.c},{type:"link",to:"/users/".concat(encodeURIComponent(e.webId)),title:"my profile",icon:xe.e},{type:"link",to:"/offers",title:"my offers",icon:xe.b},{type:"link",to:"/communities",title:"communities",icon:xe.f},{type:"button",onClick:function(){return t(ae())},title:"sign out",icon:xe.d}];return Object(ue.jsx)("nav",{className:"fixed top-4 right-4 z-500 flex items-center gap-0 bg-opacity-50 bg-white text-gray-400 rounded",children:n.map((function(e){var t=Object(ue.jsx)(e.icon,{title:e.title,className:"text-4xl p-2"}),n="p-0 hover:text-white hover:bg-opacity-100 hover:bg-black rounded";return"link"===e.type?Object(ue.jsx)(me.b,{className:n,to:e.to,children:t},e.title):Object(ue.jsx)("button",{className:n,onClick:e.onClick,children:t},e.title)}))})},we=n(13),Ie=[{hoverbg100:"hover:bg-red-100",bg200:"bg-red-200",bg300:"bg-red-300",text900:"text-red-900"},{hoverbg100:"hover:bg-yellow-100",bg200:"bg-yellow-200",bg300:"bg-yellow-300",text900:"text-yellow-900"},{hoverbg100:"hover:bg-green-100",bg200:"bg-green-200",bg300:"bg-green-300",text900:"text-green-900"},{hoverbg100:"hover:bg-blue-100",bg200:"bg-blue-200",bg300:"bg-blue-300",text900:"text-blue-900"},{hoverbg100:"hover:bg-indigo-100",bg200:"bg-indigo-200",bg300:"bg-indigo-300",text900:"text-indigo-900"},{hoverbg100:"hover:bg-purple-100",bg200:"bg-purple-200",bg300:"bg-purple-300",text900:"text-purple-900"},{hoverbg100:"hover:bg-pink-100",bg200:"bg-pink-200",bg300:"bg-pink-300",text900:"text-pink-900"}],ke=function(e){var t=e.community,n=e.isMember,c=e.onJoin,a=Object(r.useState)(Ie[Math.floor(Math.random()*Ie.length)]),o=Object(l.a)(a,1)[0];return Object(ue.jsxs)("div",{className:"w-64 p-4 ".concat(o.bg300," rounded flex flex-col gap-4"),children:[Object(ue.jsx)("header",{style:{backgroundImage:'url("'.concat(t.image,'")'),textShadow:"0 0 5px white"},className:"py-16 text-center -m-4 rounded-t bg-cover bg-center text-xl font-bold",children:t.name.en}),Object(ue.jsx)("section",{className:"mt-2 whitespace-pre-line text-justify",children:t.about.en}),n?Object(ue.jsx)("div",{className:"text-center",children:"Member"}):Object(ue.jsx)("button",{className:"".concat(o.bg200," ").concat(o.hoverbg100," ").concat(o.text900),onClick:c,children:"Join"})]})},Ne=n(47),Ce=n(227),Se=n(73),Ee=n.n(Se),Ue=function(e){var t=e.confirmString,n=e.onConfirm,c=e.onCancel,a=Object(r.useState)(!0),o=Object(l.a)(a,2),i=o[0],s=o[1],u=Object(r.useState)(""),b=Object(l.a)(u,2),d=b[0],f=b[1];return Object(ue.jsxs)(Ee.a,{isOpen:i,onRequestClose:function(){return s(!1)},onAfterClose:c,contentLabel:"Are you sure?",closeTimeoutMS:150,overlayClassName:{base:"bg-opacity-90 bg-gray-900 fixed top-0 left-0 bottom-0 right-0 z-5000",afterOpen:"",beforeClose:""},children:[Object(ue.jsx)("h1",{children:"Are you sure you want to remove offer?"}),Object(ue.jsxs)("form",{onSubmit:function(e){e.preventDefault(),d===t&&n()},className:"flex flex-col gap-2",children:[Object(ue.jsxs)("label",{children:["Please enter"," ",Object(ue.jsx)("samp",{children:Object(ue.jsx)("kbd",{children:t})})," ","below"]}),Object(ue.jsx)("input",{className:"border rounded",type:"text",value:d,onChange:function(e){return f(e.target.value)},autoFocus:!0}),Object(ue.jsx)("button",{type:"submit",disabled:t!==d,className:"disabled:opacity-50 bg-red-400 disabled:cursor-not-allowed cursor-pointer",children:"Confirm"}),Object(ue.jsx)("button",{className:"border",onClick:c,children:"Cancel"})]})]})},Le=["offer","editable"],Re=function(e){var t=e.offer,n=e.editable,c=void 0!==n&&n,a=Object(Ne.a)(e,Le),o=s(),i=Object(r.useState)(!1),u=Object(l.a)(i,2),b=u[0],d=u[1];return Object(ue.jsxs)("div",{className:"w-64 p-4 bg-blue-50 rounded flex flex-col gap-4",children:[Object(ue.jsx)(Ae,{location:t.position,className:"w-56 h-56"}),Object(ue.jsx)("section",{className:"whitespace-pre-line text-justify",children:t.about.en}),c&&"onClickEdit"in a&&Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)("button",{className:"bg-white",onClick:a.onClickEdit,children:"edit"}),Object(ue.jsx)("button",{className:"bg-red-400",onClick:function(){return d(!0)},children:"remove"}),b&&Object(ue.jsx)(Ue,{confirmString:new globalThis.URL(t.id).hash,onConfirm:function(){o(E(t)),d(!1)},onCancel:function(){return d(!1)}})]})]})},De=function(e){var t=e.location,n=Object(Ce.a)();return Object(r.useEffect)((function(){n.setView(t,12)}),[t,n]),null},Ae=function(e){var t=e.location,n=e.className,r=void 0===n?"":n;return Object(ue.jsxs)(be.a,{attributionControl:!1,center:t,zoom:12,scrollWheelZoom:"center",doubleClickZoom:"center",touchZoom:"center",className:r,children:[Object(ue.jsx)(De,{location:t}),Object(ue.jsx)(de.a,{url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(ue.jsx)(fe.a,{position:t})]})},Me=function(){var e=Object(we.f)(),t=decodeURIComponent(e.webId),n=u((function(e){return K(e,t)})),r=u((function(e){return Q(e,t)})),c=u(F),a=u((function(e){return X(e,t)})),o=s();return Object(ue.jsxs)("div",{className:"flex flex-col items-center gap-4 my-8",children:[Object(ue.jsxs)("header",{className:"flex items-center gap-2",children:[Object(ue.jsxs)("h1",{className:"italic",children:["Profile of ",Object(ue.jsx)("span",{className:"not-italic",children:n.name})]})," ",Object(ue.jsx)("a",{href:n.id,children:Object(ue.jsx)(xe.a,{className:"text-xs text-gray-400 hover:text-gray-800"})})]}),n.avatar&&Object(ue.jsx)("img",{className:"w-56 max-h-56",src:n.avatar,alt:"image of ".concat(n.name)}),Object(ue.jsx)("p",{className:"w-56 whitespace-pre-line text-justify",children:n.about.en||Object(ue.jsx)("span",{className:"text-gray-500 italic",children:"This user has no description"})}),Object(ue.jsxs)("h2",{children:["Offers (",r.length,")"]}),Object(ue.jsx)("section",{children:Object(ue.jsx)("ul",{className:"flex flex-wrap gap-6 justify-center",children:r.map((function(e){return Object(ue.jsx)("li",{children:Object(ue.jsx)(Re,{offer:e})},e.id)}))})}),Object(ue.jsxs)("h2",{children:["Communities (",a.length,")"]}),Object(ue.jsx)("section",{children:Object(ue.jsx)("ul",{className:"flex flex-wrap gap-6 justify-center",children:a.map((function(e){return Object(ue.jsx)("li",{children:Object(ue.jsx)(ke,{community:e,isMember:c.communityIds.includes(e.id)&&e.memberIds.includes(c.id),onJoin:function(){return o(P(e))}})},e.id)}))})})]})},Pe=n(20),Te=function(e){var t,n=e.offer,c=e.onSubmit,a=e.onCancel,o=e.submit,i=Object(r.useState)(n),s=Object(l.a)(i,2),u=s[0],b=s[1];Object(r.useEffect)((function(){b(n)}),[n]);return Object(ue.jsxs)("form",{className:"w-64 p-4 bg-blue-200 rounded flex flex-col gap-4",onSubmit:function(e){e.preventDefault(),c(u)},children:[Object(ue.jsx)(Ze,{location:u.position,onChange:function(e){b((function(t){return Object(Pe.a)(Object(Pe.a)({},t),{},{position:e})}))},className:"w-56 h-56"}),Object(ue.jsx)("textarea",{className:"h-40 p-1",value:null!==(t=u.about.en)&&void 0!==t?t:"",onChange:function(e){b((function(t){return Object(Pe.a)(Object(Pe.a)({},t),{},{about:{en:e.target.value}})}))},placeholder:"What can you and your place offer to guests?"}),Object(ue.jsx)("button",{className:"bg-green-300 hover:bg-green-400",type:"submit",children:o}),Object(ue.jsx)("button",{className:"hover:bg-gray-100",type:"button",onClick:a,children:"Cancel"})]})},ze=function(e){return(e%360-540)%360+180},Je=function(e){var t=e.onDrag,n=Object(Ce.b)("drag",(function(){var e=n.getCenter(),r=e.lat,c=e.lng;t([r,ze(c)]),n.setView([r,ze(c)])}));return null},We=function(e){var t=e.onLocationFound,n=Object(Ce.b)("locationfound",(function(e){var r=e.latlng,c=r.lat,a=r.lng;t([c,a]),n.flyTo([c,ze(a)])}));return null},Ze=function(e){var t=e.location,n=e.className,c=void 0===n?"":n,a=e.onChange,o=Object(r.useState)(),i=Object(l.a)(o,2),s=i[0],u=i[1];return Object(ue.jsxs)("div",{children:[Object(ue.jsxs)("section",{className:"bg-yellow-200 p-2 text-sm italic",children:["drag map to a new location or"," ",Object(ue.jsx)("button",{className:"bg-yellow-50",type:"button",onClick:function(){return null===s||void 0===s?void 0:s.locate()},children:"find your location"})]}),Object(ue.jsxs)(be.a,{attributionControl:!1,center:t,zoom:12,scrollWheelZoom:"center",doubleClickZoom:"center",touchZoom:"center",className:c,whenCreated:u,children:[Object(ue.jsx)(We,{onLocationFound:a}),Object(ue.jsx)(Je,{onDrag:a}),Object(ue.jsx)(de.a,{url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png"}),Object(ue.jsx)(fe.a,{position:t})]})]})},Fe=function(){var e,t=u(F),n=u(ie).webId,c=u((function(e){return Q(e,n)})),a=s(),o=g(n),i=Object(r.useState)(!1),b=Object(l.a)(i,2),d=b[0],f=b[1],j=Object(r.useState)(""),p=Object(l.a)(j,2),h=p[0],m=p[1],x=c.find((function(e){return e.id===h})),O=function(e){a(S({offer:e,document:o})),m("")},v=function(){f(!1),m("")};return Object(ue.jsxs)("div",{className:"flex flex-col items-center justify-evenly my-8",children:[Object(ue.jsx)("header",{children:Object(ue.jsxs)("h1",{children:["Offers of"," ",Object(ue.jsx)(me.b,{to:"/users/".concat(encodeURIComponent(n)),children:null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:"user"})]})}),Object(ue.jsxs)("ul",{className:"flex flex-wrap gap-6 justify-center",children:[c.map((function(e){return Object(ue.jsx)("li",{children:e===x?Object(ue.jsx)(Te,{offer:x,onSubmit:O,onCancel:v,submit:"Update"}):Object(ue.jsx)(Re,{offer:e,editable:!0,onClickEdit:function(){return t=e.id,m(""),f(!1),void m(t);var t}})},e.id)})),Object(ue.jsx)("li",{children:d?Object(ue.jsx)(Te,{offer:{id:"".concat(o,"#offer").concat(Date.now()),userId:n,position:[51.477,0],about:{en:""}},onSubmit:function(e){a(C({offer:e,document:o})),f(!1)},onCancel:v,submit:"Create"}):h?null:Object(ue.jsx)("button",{className:"w-64 h-64 p-4 bg-blue-400 rounded flex items-center justify-center text-5xl font-bold text-indigo-50",onClick:function(){f(!0),m("")},children:"+ Add"})})]})]})},He=function(){var e=u(Z),t=u(H),n=u(F),r=s();return Object(ue.jsxs)("div",{className:"flex flex-col items-center justify-evenly my-8",children:[Object(ue.jsx)("header",{children:Object(ue.jsx)("h1",{children:"Communities"})}),Object(ue.jsx)("ul",{className:"flex flex-wrap gap-6 justify-center",children:e.map((function(e){return Object(ue.jsx)("li",{children:Object(ue.jsx)(ke,{community:e,isMember:t.includes(e)&&e.memberIds.includes(n.id),onJoin:function(){return r(P(e))}},e.id)},e.id)}))})]})};var Be=function(){var e=u(ie),t=s();return Object(r.useEffect)((function(){t(ce())}),[t]),Object(r.useEffect)((function(){e.isLoggedIn&&["https://mrkvon.inrupt.net/hospex/sleepy-bike/community#us"].forEach((function(e){t(T(e))}))}),[e.isLoggedIn,t]),Object(ue.jsx)("div",{className:"App",children:"pending"===e.status?Object(ue.jsx)("i",{children:"Loading"}):e.isLoggedIn?Object(ue.jsxs)(me.a,{children:[Object(ue.jsx)(ye,{}),Object(ue.jsxs)(we.c,{children:[Object(ue.jsx)(we.a,{path:"/users/:webId",children:Object(ue.jsx)(Me,{})}),Object(ue.jsx)(we.a,{path:"/offers",children:Object(ue.jsx)(Fe,{})}),Object(ue.jsx)(we.a,{path:"/communities",children:Object(ue.jsx)(He,{})}),Object(ue.jsx)(we.a,{path:"/",children:Object(ue.jsx)(ve,{})})]})]}):Object(ue.jsx)(le,{})})},qe=Object(j.a)({reducer:{offer:R,community:B,user:_,login:se}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Ee.a.setAppElement("#root"),o.a.render(Object(ue.jsx)(c.a.StrictMode,{children:Object(ue.jsx)(i.a,{store:qe,children:Object(ue.jsx)(Be,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[222,1,2]]]);
//# sourceMappingURL=main.1fcdb876.chunk.js.map